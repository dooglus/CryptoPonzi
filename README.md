Don't use this code. It appears to be badly written and will probably not do what you want.
